diff --git a/enumerate_as-set_prefixes b/enumerate_as-set_prefixes
index 1234567..abcdef0 100755
--- a/enumerate_as-set_prefixes
+++ b/enumerate_as-set_prefixes
@@ -60,10 +60,25 @@ parse_args() {
     done
 }
 
+# Normalize AS_SET and extract IRR source (NTTCOM::ASxxxx or radb::ASxxxx)
+normalize_as_set() {
+    if [[ "$AS_SET" =~ ^([A-Za-z0-9]+)::(.+)$ ]]; then
+        SOURCE="${BASH_REMATCH[1]^^}"  # Uppercase IRR source
+        AS_SET="${BASH_REMATCH[2]}"
+        [[ "$DEBUG" == "1" ]] && printf_debug "%s\n" "Detected IRR source: $SOURCE"
+        [[ "$DEBUG" == "1" ]] && printf_debug "%s\n" "Stripped AS_SET: $AS_SET"
+    else
+        SOURCE="RADB"
+        [[ "$DEBUG" == "1" ]] && printf_debug "%s\n" "No IRR source specified, defaulting to RADB"
+    fi
+}
+
 process_as_sets() {
     local as_set="$1"
+
+    # Normalize source and clean AS_SET if needed
+    normalize_as_set
 
     # Parse the given as-set and figure out if it's an as-set or an aut-num
-    if [[ "$as_set" =~ ^[Aa][Ss][0-9]{1,}$ ]]; then
+    if [[ "$AS_SET" =~ ^[Aa][Ss][0-9]{1,}$ ]]; then
         if [ "$DEBUG" == "1" ]; then
-            printf_debug "$AS_SET is an aut-num"
+            printf_debug "%s\n" "$AS_SET is an aut-num"
         fi
         Is_AsSet="0"
         Is_Autnum="1"
@@ -71,7 +86,7 @@ process_as_sets() {
     elif [[ "$AS_SET" =~ ^[Aa][Ss][0-9]{1,}:[Aa][Ss]-.*$ ]]; then
         if [ "$DEBUG" == "1" ]; then
-            printf_debug "$AS_SET is an as-set with an aut-num prefix"
+            printf_debug "%s\n" "$AS_SET is an as-set with an aut-num prefix"
         fi
         Is_AsSet="1"
         Is_Autnum="0"
@@ -79,7 +94,7 @@ process_as_sets() {
     elif [[ "$AS_SET" =~ ^[Aa][Ss]-.*$ ]]; then
         if [ "$DEBUG" == "1" ]; then
-            printf_debug "$AS_SET is an as-set without an aut-num prefix"
+            printf_debug "%s\n" "$AS_SET is an as-set without an aut-num prefix"
         fi
         Is_AsSet="1"
         Is_Autnum="0"
@@ -87,7 +102,8 @@ process_as_sets() {
         if [ "$DEBUG" == "1" ]; then
-            printf_debug "$AS_SET does not match any recognized pattern" && usage
+            printf_debug "%s\n" "$AS_SET does not match any recognized pattern"
+            usage
         fi
     fi
